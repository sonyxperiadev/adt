(function(t,e){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=e(require("d3"),require("./widgets"),exports)}else if(typeof define==="function"&&define.amd){define(["d3","widgets","exports"],e)}else{t.adt=t.adt||{};t.adt.widgets=t.adt.widgets||{};t.adt.widgets.Grid=e(t.d3,t.adt.widgets.Widget,t)}})(this,function(t,e){"use strict";function r(r,i){var a=e.call(this,r,"grid","div",i);var d=a.attr.x;var s=a.attr.y;var o=1;var h=1;var n=[];var l=[];var u=false;var g=null;function w(){n.forEach(function(t){t.forEach(function(t){if(t){t.remove()}})});n=[];for(var t=0;t<h;t++){n.push([]);for(var e=0;e<o;e++){n[t].push(null)}}}this.x=function(t,e){a.attr.x=e!=="%"?t:window.innerWidth*t/100;d=a.attr.x;return this};this.y=function(t,e){a.attr.y=e!=="%"?t:window.innerHeight*t/100;s=a.attr.y;return this};this.rows=function(t){o=t;w();return this};this.cols=function(t){h=t;w();return this};this.w=function(){return a.widget};this.flexible=function(e){function r(){clearTimeout(g);g=setTimeout(function(){var e=a.attr.width/window.innerWidth;var r=a.attr.height/window.innerHeight;a.attr.x=d/=e;a.attr.y=s/=r;a.attr.width/=e;a.attr.height/=r;a.widget.style("position","absolute").style(a.attr.x>0?"left":"right",Math.abs(a.attr.x)+a.attr.xDim).style(a.attr.y>0?"top":"bottom",Math.abs(a.attr.y)+a.attr.yDim).style("width",a.attr.width+"px").style("height",a.attr.height+"px");a.widget.selectAll(".grid-border-h").style("top",function(){return t.select(this).attr("data-y")*a.attr.height/o-1+"px"}).style("width",a.attr.width+"px");a.widget.selectAll(".grid-border-v").style("left",function(){return t.select(this).attr("data-x")*a.attr.width/h-1+"px"}).style("height",a.attr.height+"px");l.forEach(function(t){t.widget.x(t.x*a.attr.width/h+a.attr.x).y(t.y*a.attr.height/o+a.attr.y).width(t.width*a.attr.width/h).height(t.height*a.attr.height/o).render(0)})},100)}if(e)window.addEventListener("resize",r);else window.removeEventListener("resize",r);return this};this.show=function(t){if(t){u=true;a.widget.style("box-shadow","0 0 1px black inset");for(var e=1;e<o;e++){a.widget.append("div").attr("class","grid-border-h").attr("data-y",e).style("position","absolute").style("left","0").style("top",e*a.attr.height/o-1.5+"px").style("width",a.attr.width+"px").style("height","3px").style("background-color","white")}for(var r=1;r<h;r++){a.widget.append("div").attr("class","grid-border-v").attr("data-x",r).style("position","absolute").style("left",r*a.attr.width/h-1.5+"px").style("top","0").style("width","3px").style("height",a.attr.height+"px").style("background-color","white")}for(e=1;e<o;e++){a.widget.append("div").attr("class","grid-border-h").attr("data-y",e).style("position","absolute").style("left","0").style("top",e*a.attr.height/o-.5+"px").style("width",a.attr.width+"px").style("height","1px").style("background-color","black")}for(r=1;r<h;r++){a.widget.append("div").attr("class","grid-border-v").attr("data-x",r).style("position","absolute").style("left",r*a.attr.width/h-.5+"px").style("top","0").style("width","1px").style("height",a.attr.height+"px").style("background-color","black")}}else{u=false;a.widget.style("border",null);a.widget.selectAll(".grid-border-h").remove();a.widget.selectAll(".grid-border-v").remove()}return this};this.add=function(t,e,r,d,s){if(e<0||d<1||e+d>h||r<0||s<1||r+s>o){t.remove();return null}for(var u=e;u<e+d;u++){if(n[u]){for(var g=r;g<r+s;g++){if(n[u][g]){t.remove();return null}}}}l.push({x:e,y:r,width:d,height:s,widget:t});for(u=e;u<e+d;u++){for(g=r;g<r+s;g++){n[u][g]=t}}t.x(e*a.attr.width/h+a.attr.x).y(r*a.attr.height/o+a.attr.y+i.attr("top")).width(d*a.attr.width/h).height(s*a.attr.height/o).render();return t};this.get=function(t,e){if(n[e]&&n[e][t]){return n[e][t].widget}else{return null}};a.render.build=function(){};a.render.update=function(t){};a.render.style=function(){a.widget.style("width",a.attr.width+"px").style("height",a.attr.height+"px");a.widget.style("display","block")}}r.prototype=Object.create(e.prototype);return r});